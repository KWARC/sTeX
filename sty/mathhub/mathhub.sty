%%
%% This is file `mathhub.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% mathhub.dtx  (with options: `package')
%% 
\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\RequirePackage{stex-base}
\RequirePackage{keyval}
\if@latexml\else\RequirePackage{xparse}\fi
\if@latexml\else\RequirePackage{xstring}\fi
\if@latexml\else\RequirePackage[abspath]{currfile}\fi
\RequirePackage{pathsuris}
\newcommand\mhcurrentrepos[1]{%
  \edef\@test{#1}%
  \ifx\@test\mh@currentrepos% if new dir = old dir
    \relax% no need to change
  \else%
    \protected@write\@auxout{}{\string\@mhcurrentrepos{#1}}%
  \fi%
  \@mhcurrentrepos{#1}% define mh@currentrepos
}%
\newcommand\@mhcurrentrepos[1]{\edef\mh@currentrepos{#1}}%
\def\modules@@first#1/#2;{#1}
\newcommand\libinput[1]{%
\edef\@@group{\expandafter\modules@@first\mh@currentrepos;}
\edef\@inffile{\MathHub{\@@group/meta-inf/lib/#1}}
\edef\@libfile{\MathHub{\mh@currentrepos/lib/#1}}%
\IfFileExists\@inffile{\input\@inffile}{}%
\IfFileExists\@inffile{}{\IfFileExists\@libfile{}{%
  {\PackageError{mathhub}
    {Library file missing; cannot input #1.tex\MessageBreak%
    Both \@libfile.tex\MessageBreak and \@inffile.tex\MessageBreak%
    do not exist}%
  {Check whether the file name is correct}}}}
\IfFileExists\@libfile{\input\@libfile}{}}
\newcommand\libusepackage[2][]{%
\edef\@@group{\expandafter\modules@@first\mh@currentrepos;}
\edef\@inffile{\MathHub{\@@group/meta-inf/lib/#2}}
\edef\@libfile{\MathHub{\mh@currentrepos/lib/#2}}%
\IfFileExists{\@inffile.sty}{\usepackage[#1]{\@inffile}}{}%
\IfFileExists {\@inffile.sty}{}{\IfFileExists{\@libfile.sty}{}{%
  {\PackageError{mathhub}
    {Library file missing; cannot use package #2.sty\MessageBreak%
    Both \@libfile.sty\MessageBreak and \@inffile.sty\MessageBreak%
    do not exist}%
  {Check whether the file name is correct}}}}
\IfFileExists{\@libfile.sty}{\usepackage[#1]{\@libfile}}{}}

% adapted from
% https://tex.stackexchange.com/questions/62010/can-i-access-system-environment-variables-from-latex-for-instance-home, check there if it breaks.

\ExplSyntaxOn
\sys_get_shell:nnN{kpsewhich ~ --var-value ~ MATHHUB} { } \MATHHUB
\tl_trim_spaces:N \l_tmpa_tl
\ifx\MATHHUB\empty\else
\def\temp_def_path#1{\defpath{MathHub}{#1}}
\expandafter\temp_def_path\expandafter{\MATHHUB}
\fi
\ExplSyntaxOff
%\mhcurrentrepos{\StrBetween\PWD\MATHHUB{/current/}}
\endinput
%%
%% End of file `mathhub.sty'.
